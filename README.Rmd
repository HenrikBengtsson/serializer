---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

library(serializer)
```

# serializer

<!-- badges: start -->
![](https://img.shields.io/badge/cool-useless-green.svg)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![R build status](https://github.com/coolbutuseless/serializer/workflows/R-CMD-check/badge.svg)](https://github.com/coolbutuseless/serializer/actions)
<!-- badges: end -->

`serializer` is a package which demonstrates how to use R's internal 
serialization interface from C.  The code is the minimum amount of code 
required to do this, and I've inserted plenty of comments for guidance.

This package was developed to help me figure out the serialization process in R.
It is perhaps only really interesting if you want to look at and/or steal the C
code.  It's under the [MIT license](https://mit-license.org/), so please feel 
free to re-use in your own projects.

If you want a rock solid version of this package that already exists, use [RApiSerialize](https://cran.r-project.org/web/packages/RApiSerialize/index.html).


## Installation

You can install from [GitHub](https://github.com/coolbutuseless/serializer) with:

``` r
# install.package('remotes')
remotes::install_github('coolbutuseless/serializer')
```


## Notes

* Using R's serialization infrastructure from C involves 2 main parts:
    * a buffer (which could be memory, a file, a pipe, etc) with accompanying 
      functions for reading and writing bytes to/from the buffer
    * input/output stream wrappers around this buffer initialised and created
      using R internals
        * Input stream: `R_inpstream_st`, `R_InitInPStream()`
        * Output stream: `R_outpstream_st`, `R_InitOutPStream()`
        
        
## Example


```{r example}
library(serializer)

v1 <- serializer::marshall(mtcars)
v2 <- base::serialize(mtcars, NULL, xdr = FALSE)

identical(v1, v2)


serializer::unmarshall(v1)
```



## Related Software

* [RApiSerialize](https://cran.r-project.org/web/packages/RApiSerialize/index.html)
* [qs](https://cran.r-project.org/web/packages/qs/index.html)
* [fst](https://cran.r-project.org/web/packages/fst/index.html)


## Acknowledgements

* R Core for developing and maintaining the language.
* CRAN maintainers, for patiently shepherding packages onto CRAN and maintaining
  the repository
